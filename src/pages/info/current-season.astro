---
import { TextSection, TextCardSection } from '@components/odyssey-theme';
import Layout from '../../layouts/Page.astro';
import HeroSection from '../../components/sections/heros/HeroSection.astro';
import CountdownSection from '@components/sections/heros/CountdownSection.astro';
import { getEntry } from 'astro:content';

const currentSeasonPage = await getEntry('pages', 'current-season');
const { data } = currentSeasonPage;

const seo = {
	title: data.title,
	description: data.description,
};
---
<Layout {seo}>
	<HeroSection>
		<div slot="text-container">
			<h1>{data.heroTitle}</h1>
			{data.events && data.events.length > 0 && (
				<ul style="list-style: none; padding: 0;">
					{data.events.map((event, index) => (
						<li style={index < data.events.length - 1 ? "margin-bottom: 1.5rem;" : ""}>
							<strong>{event.name}</strong>
							<br />
							<span>{event.date}</span>
							<br />
							<em>{event.location}</em>
							<br />
							{event.url && (
								<a href={event.url} target="_blank" rel="noopener">Event Website</a>
							)}
						</li>
					))}
				</ul>
			)}
			<hr style="margin: 2rem 0;" />
		</div>
		<picture slot="image-container">
			<img
				src={data.heroImage}
				alt={data.heroImageAlt}
				id="current-season-logo"
			/>
		</picture>
	</HeroSection>
	{data.kickoffDate && (
		<CountdownSection targetDate={data.kickoffDate} title="Kickoff Countdown"></CountdownSection>
	)}
	{data.resources && data.resources.length > 0 && (
		<TextSection narrow>
			<h3>{data.resourcesHeading || 'Resources:'}</h3>
			{data.resources.map(resource => (
				<p>
					<a href={resource.url}>{resource.text}</a>
				</p>
			))}
		</TextSection>
	)}
	{(data.preKickoffSchedule || data.postKickoffSchedule) && (
		<TextSection narrow>
			<h3>{data.scheduleHeading || 'Schedule:'}</h3>
			{data.scheduleIntro && <p>{data.scheduleIntro}</p>}
			{data.scheduleNote && (
				<p>
					<b><i>{data.scheduleNote}</i></b>
				</p>
			)}
			<ul>
				{data.preKickoffSchedule && (
					<li>
						{data.preKickoffSchedule.label}
						<ul>
							{data.preKickoffSchedule.days.map(day => (
								<li>{day.day}: {day.time}</li>
							))}
						</ul>
					</li>
				)}
				{data.postKickoffSchedule && (
					<li>
						{data.postKickoffSchedule.label}
						<ul>
							{data.postKickoffSchedule.days.map(day => (
								<li>{day.day}: {day.time}</li>
							))}
						</ul>
					</li>
				)}
			</ul>
		</TextSection>
	)}
	{data.calendarUrl && (
		<TextSection narrow>
			<h2>{data.calendarHeading || 'Calendar:'}</h2>
			<iframe
				src={data.calendarUrl}
				style="border-width:0"
				width="800"
				height="600"
				frameborder="0"
				scrolling="no"></iframe>
		</TextSection>
	)}
</Layout>
